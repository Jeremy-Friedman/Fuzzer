"""
Provides functions to check for potential vulnerabilities in a response
"""

import bs4
import requests

def checkDelay(starttime, endtime, slow):
    elapsed = endtime - starttime
    return elapsed > slow

def checkHTTPCode(response):
    if response.status_code > 400 and response.status_code < 500:
        return "Client error: " + str(response.status_code) + " " + response.reason
    elif response.status_code > 500:
        return "Server error:" + str(response.status_code) + " " + response.reason
    elif response.is_redirect:
        return "Response redirected to: " + response.url
    else:
        return False

def checkDataLeak(response,secrets):
    foundSecrets = set()
    for word in open(secrets):
        if word in response.text:
            foundSecrets.add(word)
    if len(foundSecrets) > 0:
        return "Sensitive data in response: " + str(foundSecrets)
    else:
        return False

def checkInputSanitized(response, input):
    if input in response.text:
        return "Input not sanitized: " + input
    else:
        return False
